(function(){"use strict";var e={3130:function(e,t,a){a.d(t,{Z:function(){return C}});var l=a(1527),r=(a(812),a(4525)),o=(a(8857),a(9241),a(1482),a(5191)),n=(a(5094),a(1831));const u=(0,n._)("span",null,"Заявки",-1),i=(0,n._)("span",null,"Администрирование",-1),s=(0,n.Uk)(" Мастера "),d=(0,n.Uk)(" Проделанные работы "),c=(0,n.Uk)(" Неисправности "),m=(0,n.Uk)(" Кабинеты "),p=(0,n.Uk)(" Срочности "),f=(0,n.Uk)(" Администраторы ");function h(e,t,a,h,v,b){const w=(0,n.up)("message-box"),g=o.gn,y=r.E_,_=(0,n.up)("setting"),k=(0,n.up)("user"),W=(0,n.up)("check"),V=(0,n.up)("help"),D=(0,n.up)("office-building"),S=(0,n.up)("ic-view"),x=(0,n.up)("service"),U=r.F8,C=r.Q8,j=l.zd;return(0,n.wg)(),(0,n.j4)(j,{"model-value":a.modelValue,title:"Меню","lock-scroll":"",direction:"ltr",size:h.size,onClosed:t[0]||(t[0]=t=>e.$emit("update:modelValue",!1))},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{"default-active":h.activeMenu,style:{"margin-left":"-1.25rem","margin-right":"-1.25rem"},onSelect:h.handleSelect},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{index:"/dashboard"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w)])),_:1}),u])),_:1}),(0,n.Wm)(U,{index:"/dashboard/controls"},{title:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(_)])),_:1}),i])),default:(0,n.w5)((()=>[(0,n.Wm)(y,{index:"/dashboard/controls#masters"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(k)])),_:1}),s])),_:1}),(0,n.Wm)(y,{index:"/dashboard/controls#common_works"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(W)])),_:1}),d])),_:1}),(0,n.Wm)(y,{index:"/dashboard/controls#common_defects"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(V)])),_:1}),c])),_:1}),(0,n.Wm)(y,{index:"/dashboard/controls#cabinets"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(D)])),_:1}),m])),_:1}),(0,n.Wm)(y,{index:"/dashboard/controls#urgency"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(S)])),_:1}),p])),_:1}),(0,n.Wm)(y,{index:"/dashboard/controls#administrators"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Wm)(x)])),_:1}),f])),_:1})])),_:1})])),_:1},8,["default-active","onSelect"])])),_:1},8,["model-value","size"])}var v=a(1222),b=a(5130),w=a(7758),g=a(4149),y=a(6447),_=a(4935),k=a(8699),W=a(8708),V=a(4559),D=a(7940),S={components:{MessageBox:w.Z,Setting:g.Z,User:y.Z,Service:_.Z,IcView:k.Z,Help:W.Z,Check:V.Z,OfficeBuilding:D.Z},props:{modelValue:{type:Boolean,required:!0}},setup(){const e=(0,b.tv)(),t=(0,v.iH)(""),a=(0,n.Fl)((()=>e.currentRoute.value.path+e.currentRoute.value.hash));(0,n.YP)(a,(()=>{t.value=a.value}));const l=t=>{e.push(t)},r=(0,v.iH)("20%"),o=()=>{window.innerWidth<=600?r.value="100%":window.innerWidth<=850?r.value="40%":window.innerWidth<=1100?r.value="30%":r.value="20%"};return(0,n.bv)((()=>{window.addEventListener("resize",o),o(),t.value=e.currentRoute.value.fullPath})),{handleSelect:l,size:r,activeMenu:t}}},x=a(2505);const U=(0,x.Z)(S,[["render",h]]);var C=U},6048:function(e,t,a){a(750),a(6639),a(8803),a(5967);var l=a(2847),r=a(1831);function o(e,t){const a=(0,r.up)("router-view");return(0,r.wg)(),(0,r.j4)(a)}var n=a(2505);const u={},i=(0,n.Z)(u,[["render",o]]);var s=i,d=(a(776),a(5130)),c=a(2807),m=a(433),p=(a(2275),a(5906),a(5568)),f=(a(8684),a(6150)),h=(a(7559),a(6641),a(9653),a(9517),a(9903)),v=(a(7258),a(7698)),b=(a(3075),a(3415)),w=(a(5339),a(2799)),g=(a(3047),a(361)),y=(a(5155),a(6923));const _=(0,r.Uk)(" Меню "),k=(0,r._)("h2",null,"Заявки на неисправности",-1),W=(0,r._)("h3",{style:{margin:"0","margin-right":"1rem"}},"Фильтрация",-1),V={key:0},D={style:{position:"absolute",right:"1rem",top:"1rem"}},S={style:{color:"#606266","margin-top":"1.5rem"}},x=(0,r.Uk)(" Создать отчет ");function U(e,t,a,l,o,n){const u=(0,r.up)("base-menu"),i=g.mi,s=w.dq,d=b.OX,c=(0,r.up)("filter-form"),U=v.vs,C=h.i1,j=m.nZ,O=(0,r.up)("dashboard-table"),F=m.b2,H=f.BT,T=f.km,q=p.R,Z=m.F_,P=m.G4;return(0,r.wg)(),(0,r.j4)(P,{style:{height:"100vh"}},{default:(0,r.w5)((()=>[(0,r.Wm)(P,{style:{"background-color":"white"}},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{modelValue:l.drawer,"onUpdate:modelValue":t[0]||(t[0]=e=>l.drawer=e)},null,8,["modelValue"]),(0,r.Wm)(j,{height:"auto"},{default:(0,r.w5)((()=>[(0,r.Wm)(s,null,{default:(0,r.w5)((()=>[(0,r.Wm)(i,{onClick:l.toggleDrawer,type:"text",icon:l.Menu,size:"large",style:{"margin-right":"1rem","margin-top":"0.9rem"}},{default:(0,r.w5)((()=>[_])),_:1},8,["onClick","icon"]),k,(0,r.Wm)(i,{size:"large",icon:l.RefreshRight,type:"text",style:{"margin-left":"0.5rem","margin-top":"1rem"},onClick:t[1]||(t[1]=e=>l.toggleUpdate())},null,8,["icon"])])),_:1}),(0,r.Wm)(s,null,{default:(0,r.w5)((()=>[W,(0,r.Wm)(d,{style:{"margin-top":"-0.25rem"},modelValue:l.filter,"onUpdate:modelValue":t[2]||(t[2]=e=>l.filter=e)},null,8,["modelValue"])])),_:1}),l.filter?((0,r.wg)(),(0,r.iD)("div",V,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.filterCount,(e=>((0,r.wg)(),(0,r.j4)(s,{key:e},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{id:e,onFilter:l.handleFilter,onError:l.handleError},null,8,["id","onFilter","onError"])])),_:2},1024)))),128))])):(0,r.kq)("",!0),(0,r._)("div",D,[(0,r.Wm)(C,{"confirm-button-text":"Да","cancel-button-text":"Нет",title:"Вы уверены, что хотите выйти?",onConfirm:l.logout},{reference:(0,r.w5)((()=>[(0,r.Wm)(U,{icon:l.UserFilled},null,8,["icon"])])),_:1},8,["onConfirm"])])])),_:1}),(0,r.Wm)(F,{style:{padding:"0"}},{default:(0,r.w5)((()=>[(0,r.Wm)(O,{onUpdate:t[3]||(t[3]=e=>l.handleUpdate()),update:l.update},null,8,["update"])])),_:1}),(0,r.Wm)(Z,{height:"4rem"},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{style:{"margin-left":"auto","margin-right":"0"}},{default:(0,r.w5)((()=>[(0,r._)("span",S," Всего: "+(0,y.zw)(l.totalRows)+" На странице: ",1),(0,r.Wm)(T,{modelValue:l.pageSize,"onUpdate:modelValue":t[4]||(t[4]=e=>l.pageSize=e),style:{margin:"0 0.5rem","margin-top":"1.125rem",width:"8ch"}},{default:(0,r.w5)((()=>[((0,r.wg)(),(0,r.iD)(r.HY,null,(0,r.Ko)([10,20,50,100],(e=>(0,r.Wm)(H,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),(0,r.Wm)(q,{currentPage:l.currentPage,"onUpdate:currentPage":t[5]||(t[5]=e=>l.currentPage=e),"page-size":l.pageSize,"onUpdate:page-size":t[6]||(t[6]=e=>l.pageSize=e),background:"",layout:"prev, pager, next",total:l.totalRows,style:{"margin-top":"1rem"}},null,8,["currentPage","page-size","total"]),(0,r.Wm)(i,{type:"primary",style:{margin:"0 0.5rem","margin-top":"1.125rem"},onClick:t[7]||(t[7]=e=>l.getReport())},{default:(0,r.w5)((()=>[x])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}a(212),a(4692),a(5037),a(6849);var C=a(1222),j=a(5050),O=a(4659),F=a(7067),H=(a(4491),a(3540),a(8140)),T=a(8848),q=a(500),Z=a(3130),P=a(5335),R=(a(6458),a(663)),z=(a(5376),a(4603)),E=(a(2878),a(2993));a(9853),a(7979);const A=(0,r._)("span",{style:{margin:"0 0.5rem"}},"-",-1),B=(0,r._)("span",{style:{margin:"0 0.5rem"}},"-",-1),Y=(0,r.Uk)("ОК"),I=(0,r.Uk)("Отменить");function $(e,t,a,l,o,n){const u=f.BT,i=f.km,s=P.nH,d=E.i,c=z.EZ,m=R.OF,p=g.mi,h=P.ly;return(0,r.wg)(),(0,r.j4)(h,{inline:"",ref:"formRef",model:l.form},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{label:"По"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:l.form.column,"onUpdate:modelValue":t[0]||(t[0]=e=>l.form.column=e),placeholder:"Статус","no-data-text":"Упс! Что-то пошло не так!"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.columns,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),"selectTechnician"!==l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:0,label:"Оператор"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:l.form.operator,"onUpdate:modelValue":t[1]||(t[1]=e=>l.form.operator=e),placeholder:l.form.operatorColumns.length>0?l.form.operatorColumns[0].label:" ",disabled:0===l.form.operatorColumns.length,"no-data-text":"Упс!",style:{width:"14ch"}},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.form.operatorColumns,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","disabled"])])),_:1})):(0,r.kq)("",!0),"selectTechnician"===l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:1,label:"Значение"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:l.form.value,"onUpdate:modelValue":t[2]||(t[2]=e=>l.form.value=e),placeholder:"Петров Петр","no-data-text":"Упс! Что-то пошло не так!"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.technicianOptions,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):"inputDate"===l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:2,label:"Значение"},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{modelValue:l.form.value,"onUpdate:modelValue":t[3]||(t[3]=e=>l.form.value=e),type:"date",placeholder:"Выберите день",shortcuts:l.dateInputShortcuts},null,8,["modelValue","shortcuts"])])),_:1})):"betweenDate"===l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:3,label:"Значение"},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{modelValue:l.form.value,"onUpdate:modelValue":t[4]||(t[4]=e=>l.form.value=e),type:"daterange","unlink-panels":"","range-separator":"до","start-placeholder":"Выберите начало","end-placeholder":"Выберите конец",shortcuts:l.dateRangeShortcuts},null,8,["modelValue","shortcuts"])])),_:1})):"inputStatus"===l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:4,label:"Значение"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:l.form.value,"onUpdate:modelValue":t[5]||(t[5]=e=>l.form.value=e),placeholder:l.statusOptions[0].label,"no-data-text":"Упс! Что-то пошло не так!"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.statusOptions,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1})):"betweenStatus"===l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:5,label:"Значение"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:l.form.value,"onUpdate:modelValue":t[6]||(t[6]=e=>l.form.value=e),placeholder:l.statusOptions[0].label,"no-data-text":"Упс! Что-то пошло не так!"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.statusOptions,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"]),A,(0,r.Wm)(i,{modelValue:l.form.value2,"onUpdate:modelValue":t[7]||(t[7]=e=>l.form.value2=e),placeholder:l.statusOptions[1].label,"no-data-text":"Упс! Что-то пошло не так!"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.statusOptions,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1})):"between"===l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:6,label:"Значения"},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{modelValue:l.form.value,"onUpdate:modelValue":t[8]||(t[8]=e=>l.form.value=e),placeholder:"Пожалуйста, введите значение",clearable:"",style:{width:"35ch"}},null,8,["modelValue"]),B,(0,r.Wm)(c,{modelValue:l.form.value2,"onUpdate:modelValue":t[9]||(t[9]=e=>l.form.value2=e),placeholder:"Пожалуйста, введите значение",clearable:"",style:{width:"35ch"}},null,8,["modelValue"])])),_:1})):"input"===l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:7,label:"Значение"},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{modelValue:l.form.value,"onUpdate:modelValue":t[10]||(t[10]=e=>l.form.value=e),placeholder:"Пожалуйста, введите значение",clearable:"",style:{width:"60ch"}},null,8,["modelValue"])])),_:1})):"containsWorks"===l.valueInput?((0,r.wg)(),(0,r.j4)(s,{key:8,label:"Значения"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{modelValue:l.form.value,"onUpdate:modelValue":t[11]||(t[11]=e=>l.form.value=e),placeholder:"Пожалуйста, выберите значения",options:l.containsOptions,multiple:"","allow-create":"",filterable:"",clearable:"","no-data-text":"Упс! Что-то пошло не так!",style:{width:"60ch"}},null,8,["modelValue","options"])])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(s,null,{default:(0,r.w5)((()=>[(0,r.Wm)(p,{type:"primary",onClick:t[12]||(t[12]=e=>l.submitForm()),disabled:l.formNotReady},{default:(0,r.w5)((()=>[Y])),_:1},8,["disabled"]),(0,r.Wm)(p,{onClick:t[13]||(t[13]=e=>l.resetForm())},{default:(0,r.w5)((()=>[I])),_:1})])),_:1})])),_:1},8,["model"])}var M={props:{id:{type:Number,required:!0}},emits:["filter","error"],setup(e,{emit:t}){const a=(0,C.iH)(!0),l=(0,C.iH)(null),o=[{label:"Создано в",value:"created_at"},{label:"Выполнено в",value:"done_at"},{label:"Статус",value:"status"},{label:"Кабинет",value:"cabinet"},{label:"Ф.И.О. заказчика",value:"client"},{label:"Неисправности",value:"defects"},{label:"Мастер",value:"technician_id"},{label:"Проделанные работы",value:"performed_works"}],n={equals:{label:"=",value:"="},greater:{label:">",value:">"},greaterEquals:{label:">=",value:">="},lower:{label:"<",value:"<"},lowerEquals:{label:"<=",value:"<="},between:{label:"Между",value:"between"},contains:{label:"Содержит",value:"contains"},like:{label:"Похож на",value:"like"}},u=(0,C.iH)(""),i=(0,C.qj)({column:"",operator:"",value:null,value2:null,operatorColumns:[]}),s=[{text:"Сегодня",value:new Date},{text:"Вчера",value:()=>{const e=new Date;return e.setTime(e.getTime()-864e5),e}},{text:"Неделю назад",value:()=>{const e=new Date;return e.setTime(e.getTime()-6048e5),e}}],d=[{text:"Последняя неделя",value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:"Последний месяц",value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}},{text:"Последние 3 месяца",value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]}},{text:"Последний год",value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-31536e6),[t,e]}}],m=(0,C.iH)([{label:"Просрочено",value:"1:expired"},{label:"< Часа",value:"2:hour"},{label:"< Дня",value:"3:day"},{label:"< недели",value:"4:week"},{label:"> недели",value:"5:none"},{label:"Выполнено",value:"6:completed"}]),p=(0,C.iH)([]),f=()=>{c.Z.get("/dashboard/control/technicians").then((e=>{p.value=e.data})).catch((()=>{t("error")}))},h=(0,C.iH)([]),v=e=>{c.Z.get(`/dashboard/control/${e}`).then((e=>{h.value=e.data})).catch((()=>{t("error")}))};(0,r.YP)((()=>i.column),(()=>{switch(i.column){case"":case"technician_id":i.operatorColumns=[];break;case"performed_works":i.operatorColumns=[n.equals,n.contains];break;case"defects":i.operatorColumns=[n.equals,n.like];break;case"client":i.operatorColumns=[n.equals,n.like];break;case"cabinet":i.operatorColumns=[n.equals,n.between,n.like];break;case"status":i.operatorColumns=[n.equals,n.between];break;case"done_at":default:i.operatorColumns=[n.greater,n.greaterEquals,n.lower,n.lowerEquals,n.between]}})),(0,r.YP)((()=>i.column),(()=>{i.operator=""})),(0,r.YP)((()=>[i.column,i.operator]),(()=>{if(i.value=null,""===i.column&&""===i.operator)u.value="";else if("technician_id"===i.column)f(),u.value="selectTechnician";else if("performed_works"===i.column&&i.operator)i.value=[],v("works"),u.value="containsWorks";else{switch(i.operator){case"between":u.value="between";break;case"contains":u.value="contains";break;case"=":case">":case">=":case"<":case"<=":case"like":u.value="input";break;default:u.value=""}"created_at"!==i.column&&"done_at"!==i.column||(u.value+="Date"),"status"===i.column&&(u.value+="Status")}})),(0,r.YP)((()=>[i.value,i.value2]),(()=>{i.column&&i.value&&i.value!==[]?"between"!==u.value&&"betweenStatus"!==u.value||!i.value2?"between"!==u.value&&"betweenStatus"!==u.value&&(a.value=!1):a.value=!1:a.value=!0}));const b=()=>{"between"!==u.value&&"betweenStatus"!==u.value||!i.value2?"between"!==u.value&&"betweenStatus"!==u.value&&t("filter",{id:e.id,column:i.column,operator:i.operator,value:i.value}):t("filter",{id:e.id,column:i.column,operator:i.operator,value:[i.value,i.value2]})},w=()=>{i.column="",i.operator="",i.value=null,i.value2=null,a.value=!0,t("filter",{id:e.id,delete:!0})};return{formNotReady:a,form:i,formRef:l,columns:o,valueInput:u,dateInputShortcuts:s,dateRangeShortcuts:d,statusOptions:m,technicianOptions:p,containsOptions:h,resetForm:w,submitForm:b}}};const K=(0,n.Z)(M,[["render",$]]);var N=K,L=a(6096),G=(a(3631),a(4040));a(2762),a(8483);const J={key:0,style:{"margin-left":"2rem"}},Q=(0,r._)("h4",null,"Подробности Неисправности:",-1),X={style:{"margin-right":"2rem"}};function ee(e,t,a,l,o,n){const u=(0,r.up)("dashboard-table-row"),i=L.$Y,s=G.Ks,d=L.eI;return(0,r.wg)(),(0,r.j4)(d,{data:l.tableData,"row-key":e=>e._id,style:{width:"100%",padding:"0"},stripe:"","empty-text":"Данные отсутствуют",height:"100%",onSortChange:l.changeSorting},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{type:"expand"},{default:(0,r.w5)((e=>[e.row.defect_description?((0,r.wg)(),(0,r.iD)("div",J,[Q,(0,r._)("div",X,[(0,r._)("p",null,(0,y.zw)(e.row.defect_description),1)])])):(0,r.kq)("",!0),(0,r.Wm)(u,{prop:e,masters:l.masters,commonPerformedWorks:l.commonPerformedWorks,"onSubmit:error":t[0]||(t[0]=e=>l.submitError()),"onSubmit:success":t[1]||(t[1]=e=>l.submitSuccess()),style:{"margin-left":"2rem"}},null,8,["prop","masters","commonPerformedWorks"])])),_:1}),(0,r.Wm)(i,{label:"Создано в",prop:"created_at",width:"145",sortable:"custom"}),(0,r.Wm)(i,{label:"Выполнено в",prop:"done_at",width:"145"}),(0,r.Wm)(i,{label:"Статус",prop:"status",align:"center",width:"130",sortable:"custom"},{default:(0,r.w5)((e=>[(0,r.Wm)(s,{effect:"dark",type:l.getStatusType(e.row.status)},{default:(0,r.w5)((()=>[(0,r.Uk)((0,y.zw)(l.getStatus(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),(0,r.Wm)(i,{label:"Кабинет",prop:"cabinet",width:"180"}),(0,r.Wm)(i,{label:"Ф.И.О. заказчика",prop:"client",width:"260"}),(0,r.Wm)(i,{label:"Телефон",prop:"client_phone",width:"120"}),(0,r.Wm)(i,{label:"Неисправности",prop:"defects","min-width":"300"})])),_:1},8,["data","row-key","onSortChange"])}var te=a(701);const ae=(0,r._)("h4",null,"Проделанные работы:",-1),le=(0,r.Uk)("Сохранить");function re(e,t,a,l,o,n){const u=f.BT,i=f.km,s=P.nH,d=g.mi,c=P.ly;return(0,r.wg)(),(0,r.iD)("div",null,[ae,(0,r.Wm)(c,{ref:"formRef",class:"form","label-position":"top",model:o.form,rules:o.rules,inline:""},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{label:"Мастер",prop:"technician_id"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:o.form.technician_id,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.technician_id=e),placeholder:"Пожалуйста, выберите мастера","no-data-text":"Упс! Что-то пошло не так!",style:{"min-width":"42ch"}},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.masters,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(s,{label:"Проделанные работы",prop:"performed_works"},{default:(0,r.w5)((()=>[(0,r.Wm)(i,{modelValue:o.form.performed_works,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.performed_works=e),placeholder:"Пожалуйста, выберите проделанные работы",multiple:"","allow-create":"",filterable:"",clearable:"","no-data-text":"Упс! Что-то пошло не так!",style:{"min-width":"80ch"}},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.commonPerformedWorks,(e=>((0,r.wg)(),(0,r.j4)(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(s,{label:"ㅤ"},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{type:"primary",onClick:t[2]||(t[2]=e=>n.submitForm())},{default:(0,r.w5)((()=>[le])),_:1})])),_:1})])),_:1},8,["model","rules"])])}var oe={props:{prop:{type:Object,required:!0},commonPerformedWorks:{type:Array,required:!0},masters:{type:Array,required:!0}},emits:["submit:error","submit:success"],data(){return{form:{id:this.prop.row._id,technician_id:this.prop.row.technician_id,performed_works:this.prop.row.performed_works},rules:{technician_id:[{required:!0,message:"Пожалуйста, укажите мастера",trigger:"blur"}],performed_works:[{required:!0,message:"Пожалуйста, укажите проделанные работы",trigger:"blur"}]}}},methods:{sendData(){c.Z.patch("/dashboard/table",this.form).then((()=>{this.$emit("submit:success",this._id)})).catch((()=>{this.$emit("submit:error")}))},submitForm(){this.$refs.formRef.validate((e=>!!e&&(this.sendData(),!0)))}}};const ne=(0,n.Z)(oe,[["render",re]]);var ue=ne,ie={components:{DashboardTableRow:ue},emits:["update"],props:{update:{type:Boolean,required:!1,default:!1}},setup(e,{emit:t}){const a=(0,j.oR)(),l=(0,r.Fl)((()=>a.getters.optionsAndFilters)),o=(0,C.iH)([]),n=(0,C.iH)([]),u=(0,C.iH)([]),i=e=>{switch(e){case"6:completed":return"success";case"1:expired":return"danger";case"2:hour":return"warning";case"3:day":return"";case"4:week":case"5:none":return"info";default:return"info"}},s=e=>{switch(e){case"6:completed":return"Выполнено";case"1:expired":return"Просрочено";case"2:hour":return"< Часа";case"3:day":return"< Дня";case"4:week":return"< недели";case"5:none":return"> недели";default:return"Неизвестно"}},d=e=>e<10?`0${e}`:`${e}`,m=e=>`${d(e.getFullYear())}-${d(e.getMonth()+1)}-${d(e.getDate())} ${d(e.getHours())}:${d(e.getMinutes())}`,p=()=>{for(let e=0;e<u.value.length;e++)u.value[e].created_at=m(new Date(u.value[e].created_at)),u.value[e].done_at&&(u.value[e].done_at=m(new Date(u.value[e].done_at)))},f=()=>{c.Z.post("/dashboard/table",l.value).then((e=>{u.value=e.data,p()})).catch((()=>{O.z8.error("Упс! Не удалось загрузить данные!")}))};(0,r.YP)(l,(()=>{f()}));const h=()=>{c.Z.get("/dashboard/control/technicians").then((e=>{o.value=e.data})).catch((()=>{O.z8.error("Упс! Не удалось загрузить данные!")}))},v=()=>{c.Z.get("/dashboard/control/works").then((e=>{n.value=e.data})).catch((()=>{O.z8.error("Упс! Не удалось загрузить данные!")}))},b=()=>{O.z8.success("Успешно сохранено"),f()},w=()=>{O.z8.error("Упс! Не удалось сохранить данные")},g=({prop:e,order:t})=>{a.dispatch("setOptions",{orderBy:e,orderDirection:t})};(0,r.YP)((()=>e.update),(()=>f()));const y=(0,te.io)("https://mtec-support.herokuapp.com/",{transports:["websocket"]});return y.on("row:new",(()=>{f(),t("update")})),(0,r.bv)((()=>{f(),h(),v()})),{tableData:u,masters:o,commonPerformedWorks:n,getStatusType:i,getStatus:s,submitSuccess:b,submitError:w,changeSorting:g}}};const se=(0,n.Z)(ie,[["render",ee]]);var de=se,ce={components:{BaseMenu:Z.Z,FilterForm:N,DashboardTable:de},setup(){const e=(0,j.oR)(),t=(0,d.tv)(),a=(0,C.iH)(!1),l=(0,C.iH)(1),o=(0,C.iH)(1),n=(0,C.iH)(1),u=(0,C.iH)(50),i=(0,C.iH)(!1),s=()=>{i.value=!i.value},m=()=>{c.Z.post("/dashboard/table/count",e.getters.filters).then((e=>{o.value=parseInt(e.data.count,10)})).catch((()=>{O.z8.error("Упс! Не удалось загрузить страницы!")}))},p=()=>{c.Z.get("/dashboard/report",{params:{filters:JSON.stringify(e.getters.optionsAndFilters)},responseType:"blob"}).then((e=>{console.log(e.data);const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","Report.xlsx"),document.body.appendChild(a),a.click()})).catch((()=>{O.z8.error("Упс! Не удалось загрузить отчет!")}))},f=(0,C.iH)(!1),h=()=>{m(),f.value=!f.value},v=()=>{m(),(0,F.bM)({title:"Новая заявка",message:(0,r.h)("i",{style:"color: teal"},"Появилась новая заявка!")})};(0,r.YP)([n,u],(()=>{e.dispatch("setOptions",{limit:u.value,page:n.value})})),(0,r.YP)(a,(()=>{if(!a.value)for(let t=1;t<=l.value;t++)e.dispatch("removeFilters",t);l.value=1}));const b=()=>{c.Z.post("/dashboard/auth/logout").then((()=>{t.push("/dashboard/login")}))};(0,r.bv)((()=>{m()}));const w=t=>{t.delete?(e.dispatch("removeFilters",{id:t.id}),l.value=t.id):(e.dispatch("addFilters",t),l.value=8===l.value?8:t.id+1),m()},g=()=>{O.z8.error("Упс! Что-то пошло не так")};return{filter:a,filterCount:l,drawer:i,toggleDrawer:s,handleUpdate:v,getReport:p,update:f,toggleUpdate:h,totalRows:o,currentPage:n,pageSize:u,logout:b,handleFilter:w,handleError:g,UserFilled:H.Z,Menu:T.Z,RefreshRight:q.Z}}};const me=(0,n.Z)(ce,[["render",U]]);var pe=me;const fe=[{path:"/dashboard",name:"home",component:pe,meta:{requiresAuth:!0}},{path:"/dashboard/login",name:"login",component:()=>a.e(462).then(a.bind(a,6462)),meta:{requiresAuth:!1}},{path:"/dashboard/register",name:"register",component:()=>a.e(446).then(a.bind(a,6446)),meta:{requiresAuth:!1}},{path:"/dashboard/controls",name:"controls",component:()=>a.e(460).then(a.bind(a,460)),meta:{requiresAuth:!0}}],he=(0,d.p7)({BASE_URL:"/dashboard",history:(0,d.PO)("/"),routes:fe});he.beforeEach((async(e,t,a)=>{try{const t=await c.Z.get("/dashboard/auth/check");t.data.authorized?e.meta.requiresAuth?a():a("/dashboard"):e.meta.requiresAuth?a("/dashboard/login"):a()}catch(l){a()}}));var ve=he,be=(0,j.MT)({state:{limit:50,page:1,orderBy:"created_at",orderDirection:"desc",filters:[]},getters:{optionsAndFilters(e){return{limit:e.limit,page:e.page,orderBy:e.orderBy,orderDirection:e.orderDirection,filters:e.filters}},filters(e){return{filters:e.filters}},lastFilter(e){let t="";return e.filters.forEach((e=>{t=e.id>t?e.id:t})),t}},mutations:{setOptions(e,t){t.limit||t.page?(t.limit&&(e.limit=t.limit),t.page&&(e.page=t.page)):(t.orderBy?e.orderBy=t.orderBy:e.orderBy="",t.orderDirection?e.orderDirection=t.orderDirection:e.orderDirection="")},addFilters(e,t){e.filters=e.filters.filter((e=>e.id!==t.id)),e.filters.push(t)},removeFilters(e,t){e.filters=e.filters.filter((e=>e.id<t.id))}},actions:{setOptions(e,t){e.commit("setOptions",t)},addFilters(e,t){e.commit("addFilters",t)},removeFilters(e,t){e.commit("removeFilters",t)}}});(0,l.ri)(s).use(be).use(ve).mount("#app")},2807:function(e,t,a){var l=a(1489),r=a.n(l);const o="https://mtec-support.herokuapp.com",n=r().create({baseURL:`${o}/support/api`,headers:{"Content-type":"application/json"},withCredentials:!0});t["Z"]=n}},t={};function a(l){var r=t[l];if(void 0!==r)return r.exports;var o=t[l]={exports:{}};return e[l].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,l,r,o){if(!l){var n=1/0;for(d=0;d<e.length;d++){l=e[d][0],r=e[d][1],o=e[d][2];for(var u=!0,i=0;i<l.length;i++)(!1&o||n>=o)&&Object.keys(a.O).every((function(e){return a.O[e](l[i])}))?l.splice(i--,1):(u=!1,o<n&&(n=o));if(u){e.splice(d--,1);var s=r();void 0!==s&&(t=s)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[l,r,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,l){return a.f[l](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+"."+{446:"4890cc35",460:"736520f9",462:"a0ebb923"}[e]+".js"}}(),function(){a.miniCssF=function(e){return"css/"+e+"."+{446:"60bc0881",460:"826ed4cf",462:"60bc0881"}[e]+".css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="diploma-front:";a.l=function(l,r,o,n){if(e[l])e[l].push(r);else{var u,i;if(void 0!==o)for(var s=document.getElementsByTagName("script"),d=0;d<s.length;d++){var c=s[d];if(c.getAttribute("src")==l||c.getAttribute("data-webpack")==t+o){u=c;break}}u||(i=!0,u=document.createElement("script"),u.charset="utf-8",u.timeout=120,a.nc&&u.setAttribute("nonce",a.nc),u.setAttribute("data-webpack",t+o),u.src=l),e[l]=[r];var m=function(t,a){u.onerror=u.onload=null,clearTimeout(p);var r=e[l];if(delete e[l],u.parentNode&&u.parentNode.removeChild(u),r&&r.forEach((function(e){return e(a)})),t)return t(a)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=m.bind(null,u.onerror),u.onload=m.bind(null,u.onload),i&&document.head.appendChild(u)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.j=966}(),function(){a.p="/"}(),function(){var e=function(e,t,a,l){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css";var o=function(o){if(r.onerror=r.onload=null,"load"===o.type)a();else{var n=o&&("load"===o.type?"missing":o.type),u=o&&o.target&&o.target.href||t,i=new Error("Loading CSS chunk "+e+" failed.\n("+u+")");i.code="CSS_CHUNK_LOAD_FAILED",i.type=n,i.request=u,r.parentNode.removeChild(r),l(i)}};return r.onerror=r.onload=o,r.href=t,document.head.appendChild(r),r},t=function(e,t){for(var a=document.getElementsByTagName("link"),l=0;l<a.length;l++){var r=a[l],o=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(o===e||o===t))return r}var n=document.getElementsByTagName("style");for(l=0;l<n.length;l++){r=n[l],o=r.getAttribute("data-href");if(o===e||o===t)return r}},l=function(l){return new Promise((function(r,o){var n=a.miniCssF(l),u=a.p+n;if(t(n,u))return r();e(l,u,r,o)}))},r={966:0};a.f.miniCss=function(e,t){var a={446:1,460:1,462:1};r[e]?t.push(r[e]):0!==r[e]&&a[e]&&t.push(r[e]=l(e).then((function(){r[e]=0}),(function(t){throw delete r[e],t})))}}(),function(){var e={966:0};a.f.j=function(t,l){var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)l.push(r[2]);else{var o=new Promise((function(a,l){r=e[t]=[a,l]}));l.push(r[2]=o);var n=a.p+a.u(t),u=new Error,i=function(l){if(a.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var o=l&&("load"===l.type?"missing":l.type),n=l&&l.target&&l.target.src;u.message="Loading chunk "+t+" failed.\n("+o+": "+n+")",u.name="ChunkLoadError",u.type=o,u.request=n,r[1](u)}};a.l(n,i,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,l){var r,o,n=l[0],u=l[1],i=l[2],s=0;if(n.some((function(t){return 0!==e[t]}))){for(r in u)a.o(u,r)&&(a.m[r]=u[r]);if(i)var d=i(a)}for(t&&t(l);s<n.length;s++)o=n[s],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},l=self["webpackChunkdiploma_front"]=self["webpackChunkdiploma_front"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[998],(function(){return a(6048)}));l=a.O(l)})();
//# sourceMappingURL=dashboard.13773be8.js.map